# 新規検索ページ実装計画

## ゴール
過去の当選番号を検索・分析できる多機能な検索ページ `docs/search/index.html` を作成する。
単なる検索だけでなく、**ボックス検索、次回出現傾向、出現間隔、ヒートマップ**などの分析機能を提供する。

## ユーザーレビューが必要な項目
- 特になし。

## 変更内容
### Numbers3 プロジェクト

#### [NEW] `docs/search/` ディレクトリ作成
- `docs/search/`

#### [NEW] [docs/search/index.html](file:///c:/Users/sora0/OneDrive/github/numbers3/docs/search/index.html)
- `../public/styles.css` を利用し、メインデザインと統一。
- **機能UI**:
    - 数字選択（百・十・一）。
    - **検索モード切替**: 「ストレート（完全一致）」or「ボックス（順不同）」。
    - 検索ボタン。
- **結果表示UI**:
    - **基本統計**: 当選回数、確率。
    - **出現間隔（ギャップ）**: 平均間隔、最短/最長間隔、前回の出現からの経過回数。
    - **次回出現傾向**: この数字が出た**翌回**によく出る数字・合計値・パリティ（偶奇）の傾向表示。
    - **ヒートマップ**: 曜日別・月別の出現頻度グラフ（Chart.jsを使用）。
    - **当選履歴リスト**: 日付と番号のテーブル。

#### [NEW] [docs/search/app.js](file:///c:/Users/sora0/OneDrive/github/numbers3/docs/search/app.js)
- `../public/data.json` をロード。
- **ロジック**:
    - `searchStraight(h, t, o)`: 完全一致検索。
    - `searchBox(h, t, o)`: 数字の組み合わせで検索（例: 123 -> 123, 132, 213, 231, 312, 321）。
    - `analyzeNextDraw(filteredIndices, allData)`: ヒットした回の**次の回**のデータを集計。
    - `analyzeGaps(filteredIndices)`: 出現間隔の統計計算。
    - `analyzeTimeDistribution(filteredIndices)`: 曜日・月別の集計。

#### [MODIFY] [docs/index.html](file:///c:/Users/sora0/OneDrive/github/numbers3/docs/index.html)
- サイドバーのメニューに **「🔎 過去データ検索・分析」** へのリンクを追加。

## 検証計画
- ボックス検索で「123」を検索し、「321」などの並び替えデータもヒットすることを確認。
- 次回傾向分析で、表示される統計が直感的に正しいか確認（例：データを見て手計算と比較）。
- ヒートマップが描画されることを確認。

## 追加機能（Ver.2）

### 1. 📅 日付検索（逆引き検索）
- **UI**: 検索フォームに「数字検索 / 日付検索」の切り替えタブを追加。
- **機能**: 月日（例: 12月23日）を指定して、過去のその日に出た当選番号を表示。

### 2. 💰 収支シミュレーション
- **UI**: 検索結果エリアに「収支シミュレーション」セクションを追加。
- **機能**:
    - 投資設定: 「購入口数（デフォルト1口）」、「購入タイプ（ストレート/ボックス）」。
    - 計算: (当選回数 × 当選金) - (総抽選回数 × 購入金額)。
    - 結果: 回収率（ROI）と損益グラフを表示。

### 3. 📥 CSVエクスポート
- **UI**: 検索結果ヘッダーに「CSVダウンロード」ボタンを追加。
- **機能**: 現在表示されている検索結果（日付、回号、番号、曜日）をCSV形式でダウンロード。

### 4. 📱 PWA化 (Progressive Web App)
- **ファイル作成**: `docs/manifest.json`, `docs/service-worker.js`。
- **メタタグ追加**: `index.html`, `search/index.html` にマニフェスト読み込みとアイコン設定を追加。
- **機能**: ホーム画面への追加、オフラインキャッシュ（主要リソース）。

## 検証計画（追加分）
- 日付検索で「自分の誕生日」などを入力し、結果が出るか。
- シミュレーションで、購入金額を変更して損益が変わるか。
- CSVボタンを押してファイルがダウンロードできるか。
- Chrome DevToolsのLighthouseまたはApplicationタブでPWAとして認識されるか。

